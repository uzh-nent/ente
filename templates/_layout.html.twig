{% extends '_base.html.twig' %}

{% trans_default_domain "index" %}

{% macro nav_item(link, text) %}
    <li class="nav-item">
        <a class="nav-link {% if app.request.pathInfo starts with link %}active{% endif %}"
           href="{{ link }}">{{ text }}</a>
    </li>
{% endmacro %}
{% import _self as own_macros %}

{% block body %}
    <div class="container-fluid p-0">
        <div class="d-flex flex-row vh-100">
            <div class="d-flex flex-column justify-content-between bg-light px-2 py-3">
                <div class="menu">
                    <p>
                        ðŸ¦† | <b id="shortname">{{ app.user.shortname }}</b>
                        <a href="/logout">{{ "logout.title"|trans({}, 'security') }}</a>
                    </p>

                    {% set is_admin = app.request.pathInfo starts with "/admin" %}

                    <div id="user-nav" {% if is_admin %}class="d-none"{% endif %}>
                        <h4 class="mt-5">{{ "entity.plural"|trans({}, "entity_probe") }}</h4>
                        <ul class="nav nav-pills flex-column">
                            {{ own_macros.nav_item(path('probe_new'), "new.title"|trans({}, "probe")) }}
                            {{ own_macros.nav_item(path('probe_active'), "active.title"|trans({}, "probe")) }}
                            {{ own_macros.nav_item(path('probe_all'), "all.title"|trans({}, "probe")) }}
                        </ul>

                        <h4 class="mt-5">{{ "index.title"|trans({}, "master_data") }}</h4>
                        <ul class="nav nav-pills flex-column">
                            {{ own_macros.nav_item(path('master_data_organizations'), "organizations.title"|trans({}, "master_data")) }}
                            {{ own_macros.nav_item(path('master_data_patients'), "patients.title"|trans({}, "master_data")) }}
                            {{ own_macros.nav_item(path('master_data_animal_keepers'), "animal_keepers.title"|trans({}, "master_data")) }}
                        </ul>
                    </div>

                    <div id="admin-nav" {% if not is_admin %}class="d-none"{% endif %}>
                        <h4 class="mt-5">{{ "index.title"|trans({}, "reference_data") }}</h4>
                        <ul class="nav nav-pills flex-column">
                            {{ own_macros.nav_item(path('reference_data_leading_codes'), "leading_codes.title"|trans({}, "reference_data")) }}
                            {{ own_macros.nav_item(path('reference_data_organisms'), "organisms.title"|trans({}, "reference_data")) }}
                            {{ own_macros.nav_item(path('reference_data_specimen'), "specimen.title"|trans({}, "reference_data")) }}
                        </ul>
                    </div>
                </div>

                <div>
                    <ul class="nav nav-pills flex-column">
                        <li class="nav-item">
                            <a id="admin-toggle" class="nav-link {% if is_admin %}active{% endif %}"
                               href="#">{{ "index.title"|trans({}, "administration") }}</a>
                        </li>
                    </ul>
                    <p class="mb-0">
                        {{ 'layout.open_source'|trans }}
                        <a href="https://gitlab.uzh.ch/uzh-nent/ente" target="_blank">nent/ente</a>.
                    </p>
                </div>
            </div>
            <div class="divider ms-2"></div>
            <div class="content flex-grow-1 px-2 py-2">
                <div>
                    {% if breadcrumbs is defined and breadcrumbs|length > 0 %}
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb mt-3">
                                {% for breadcrumb in breadcrumbs %}
                                    {% if not (breadcrumb.path ends with app.request.pathinfo) %}
                                        <li class="breadcrumb-item">
                                            <a href="{{ breadcrumb.path }}">
                                                {{ breadcrumb.name }}
                                            </a>
                                        </li>
                                    {% endif %}
                                {% endfor %}
                                <li class="breadcrumb-item active" aria-current="page">
                                    {{ title }}
                                </li>
                            </ol>
                        </nav>
                    {% endif %}
                </div>
                {% block content %}

                {% endblock %}
            </div>
        </div>
    </div>
{% endblock %}
